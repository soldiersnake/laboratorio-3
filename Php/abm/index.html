<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario BBDD</title>
    <style>
        html,
        body {
            width: 100vw;
            height: 100%;
            padding: 0;
            margin: 0;
        }

        h2 {
            color: yellow;
        }

        #contenedor {
            width: 100%;
            height: 100%;
            background-image: url('./imagenes/fondoPokemon.png');
            background-size: cover;
            background-position: center;
        }

        table {
            /* display: block; */
            display: table;
            height: 100%;
            width: 100vw;
            border-collapse: collapse;
            overflow: auto;
        }

        header,
        footer {
            font-weight: bold;
            background-color: black;
            height: 10%;
            width: 100%;
            color: white;
            padding: 30px;
            box-sizing: border-box;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        footer {
            position: fixed;
            bottom: 0;
            left: 0;
        }

        .th {
            text-align: center;
            background-color: rgba(255, 0, 0, 0.774);
            padding: 10px 10px 25px 10px;
            box-sizing: border-box;
            border-right: 2px solid orange;
            cursor: pointer;
        }

        [campo-dato="id"] {
            width: 10vw;
        }

        [campo-dato="marca"] {
            width: 30vw;
        }

        [campo-dato="modelo"] {
            width: 30vw;
        }

        [campo-dato="precio"] {
            width: 20vw;
        }

        /* [campo-dato = "año"]
        {
            width: 10vw;
        } */

        /* [campo-dato = "deporte"]
        {
            width: 20vw;
            color: darkslateblue;
            font-weight: bold;
        } */

        tbody tr:nth-child(odd) {
            background-color: rgb(220, 227, 126);
        }

        tbody tr:nth-child(even) {
            background-color: rgb(229, 102, 79);
        }

        td {
            padding: 20px;
            box-sizing: border-box;
        }

        .marginIzquierdo {
            margin-right: 20px;
        }

        @media (max-width: 900px) {
            /* [campo-dato = "año"]
            {
                display: none;
            } */

            [campo-dato="precio"] {
                width: 35vw;
            }
        }

        @media (max-width: 600px) {
            [campo-dato="precio"] {
                display: none;
            }

            [campo-dato="modelo"] {
                width: 60vw;
            }
        }

        /* @media (max-width: 600px)
        {
            [campo-dato = "precio"]
            {
                display: none;
            }

            [campo-dato = "deporte"]
            {
                width: 85vw;
            }
        } */

        button {
            border-radius: 15px;
            background-color: white;
            font-weight: bold;
        }

        button:hover {
            cursor: pointer;
            background-color: black;
            color: yellow;
            border: 4px solid yellow;
        }

        #botones {
            position: fixed;
            right: 20px;
        }

        #botones button {
            padding: 10px;
            width: 100px;
            font-weight: bold;
        }


        /* ////////////////////////// */

        h3 {
            margin: 0;
        }

        #titulo {
            background-color: black;
            color: white;
            height: 10%;
            width: 100%;
            padding-left: 10px;
            box-sizing: border-box;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .opcion {
            float: left;
            height: 30%;
            width: 50%;
        }

        thead {
            width: 100%;
        }

        thead input {
            display: block;
            width: 100%;
            padding: 5px;
            box-sizing: border-box;
            margin: auto;
        }

        button {
            padding: 5px;
        }
    </style>
</head>

<body>
    <div id="contenedor">
        <header>
            <h2>ABM form's - Pokemon</h2>
            <div id="botones">

                <!-- <input type="text" readonly id="orden" value="Precio"> -->
                <button id="cargar">Cargar</button>
                <button id="vaciar">Vaciar</button>
                <button id="limpiarFiltros">Limpiar</button>
                <button id="altaRegistro">Alta</button>
            </div>
        </header>
        <table>
            <thead>
                <tr>
                    <th campo-dato="id" class="th" id="thId">ID</th>
                    <!-- <th campo-dato="description" class="th" id="thDescription">Descripcion</th> -->
                    <th campo-dato="nombre" class="th" id="thNombre">Nombre</th>
                    <th campo-dato="tipo" class="th" id="thTipo">Tipo</th>
                    <th campo-dato="ataque" class="th" id="thAtaque">Ataque principal</th>
                    <th campo-dato="debilidad" class="th" id="thPrecio">Debilidad</th>
                    <th campo-dato="pdf" class="th" id="thPdf">Pdf's</th>
                    <th campo-dato="modificacion" class="th" id="thPrecio">Modificacion</th>
                    <th campo-dato="baja" class="th" id="thPrecio">Baja</th>

                    <!-- <th campo-dato="año" class="th" id="thAño">Año</th> -->
                </tr>
                <tr>
                    <td campo-dato="id" class="th"><input id="filtroId" type="text"></td>
                    <!-- <td campo-dato="marca" class="th"  ><input id="filtroDescription" type="text"></td> -->
                    <td campo-dato="nombre" class="th"><input id="filtroNombre" type="text"></td>
                    <td campo-dato="tipo" class="th"><select id="filtroTipo"></select></td>
                    <td campo-dato="ataque" class="th"><input id="filtroAtaque" type="text"></td>
                    <td campo-dato="debilidad" class="th"><input id="filtroDebilidad" type="text"></td>
                    <td campo-dato="pdf" class="th"></td>
                    <td campo-dato="modificacion" class="th"></td>
                    <td campo-dato="baja" class="th"></td>


                    <!-- <td campo-dato="año" class="th" ><input id="filtroFecha" type="text"></td> -->
                </tr>

            </thead>
            <tbody id="tabla">

            </tbody>
        </table>
        <footer>
            <h2>
                Mariano Macias - Laboratorio 3
            </h2>
        </footer>


    </div>

</body>

</html>

<script src="../jquery.js"></script>

<script>

    var flag = 0;

    $(document).ready(() => {

        $("#thId").click(() => {
            $("#orden").val("id");
        });

        $("#thDescription").click(() => {
            $("#orden").val("description");
        });

        $("#thMarca").click(() => {
            $("#orden").val("marca");
        });

        $("#thModelo").click(() => {
            $("#orden").val("modelo");
        });

        $("#thPrecio").click(() => {
            $("#orden").val("precio");
        });

        // Realizar la petición AJAX para obtener los tipos
        $.ajax({
        type: "GET",
        url: "salidaJsonFamilias.php",
        success: (respuestaServer) => {
            // Convertir la respuesta en un arreglo de tipos
            const tipos = JSON.parse(respuestaServer);

            // Eliminar duplicados y ordenar los tipos alfabéticamente
            const tiposUnicos = [...new Set(tipos)].sort();

            // Mostrar los tipos en una alerta
            alert("Tipos: " + tiposUnicos.join(", "));

            // Llenar el select del filtroTipo con los tipos únicos
            const filtroTipo = $("#filtroTipo");
            tiposUnicos.forEach((tipo) => {
                filtroTipo.append($("<option></option>").text(tipo));
            });
        }
    });



        $("#cargar").click(() => {
            console.log("cargando...");
            $("#tabla").empty();
            $("#tabla").html("<h3><i>Cargando datos...</i></h3>");

            $.ajax({
                type: "GET",
                url: "salidaJsonFamilias.php",
                success: (respuestaServer) => {
                    const opcionesTipo = $("#filtroTipo");
                    opcionesTipo.empty(); // Limpiar las opciones existentes

                    // Agregar las opciones obtenidas del servidor
                    opcionesTipo.append(respuestaServer);
                    alert(respuestaServer);

                    console.log("cargando...");
                    $("#tabla").empty();
                    $("#tabla").html("<h3><i>Cargando datos...</i></h3>");

                    $.ajax({
                        type: "GET",
                        url: "salidaJsonArticulos.php",
                        success: (respuestaServer) => {
                            console.log(respuestaServer);

                            const objJson = JSON.parse(respuestaServer);

                            // Obtener los tipos de la respuesta del servidor
                            const tipos = objJson.map((valor) => valor.tipo);

                            // Eliminar duplicados y ordenar los tipos alfabéticamente
                            const tiposUnicos = [...new Set(tipos)].sort();

                            // Llenar el select del filtroTipo con los tipos únicos
                            const filtroTipo = $("#filtroTipo");
                            filtroTipo.empty();
                            tiposUnicos.forEach((tipo) => {
                                filtroTipo.append($("<option></option>").text(tipo));
                            });

                            $("#tabla").empty();
                            objJson.forEach((valor) => {
                                const objTr = document.createElement("tr");

                                const tdId = document.createElement("td");
                                tdId.innerHTML = valor.id;
                                objTr.appendChild(tdId);

                                const tdNombre = document.createElement("td");
                                tdNombre.innerHTML = valor.nombre;
                                objTr.appendChild(tdNombre);

                                const tdTipo = document.createElement("td");
                                tdTipo.innerHTML = valor.tipo;
                                objTr.appendChild(tdTipo);

                                const tdAtaque = document.createElement("td");
                                tdAtaque.innerHTML = valor.ataque_principal;
                                objTr.appendChild(tdAtaque);

                                const tdDebilidad = document.createElement("td");
                                tdDebilidad.innerHTML = valor.debilidad;
                                objTr.appendChild(tdDebilidad);

                                const tdPdf = document.createElement("td");
                                const botonPdf = document.createElement("button");
                                botonPdf.innerText = "PDF";
                                botonPdf.addEventListener("click", btnPDF);
                                tdPdf.appendChild(botonPdf);
                                objTr.appendChild(tdPdf);

                                const tdModi = document.createElement("td");
                                const botonModi = document.createElement("button");
                                botonModi.innerText = "Modi";
                                botonModi.addEventListener("click", btnModi);
                                tdModi.appendChild(botonModi);
                                objTr.appendChild(tdModi);

                                const tdBaja = document.createElement("td");
                                const botonBaja = document.createElement("button");
                                botonBaja.innerText = "Baja";
                                botonBaja.addEventListener("click", btnBaja);
                                tdBaja.appendChild(botonBaja);
                                objTr.appendChild(tdBaja);

                                $("#tabla").append(objTr);
                            });
                        }
                    });
                }
            });



        });

    });

    $("#vaciar").click(() => {
        $("#tabla").empty();
        flag = 0;
    })

    function btnPDF() {
        // Acción del botón PDF
        console.log("Botón PDF clickeado");
    }

    function btnModi() {
        // Acción del botón Modi
        console.log("Botón Modi clickeado");
    }

    function btnBaja() {
        // Acción del botón Baja
        console.log("Botón Baja clickeado");
    }


    // objDeportes.deportes.forEach(opc => {
    //     var opcion = document.createElement("option");
    //     opcion.setAttribute("value", opc.nombre);
    //     opcion.innerText = opc.nombre;
    //     deportes.appendChild(opcion);
    // });

    // $("#modal").click(function(){
    //     document.getElementById("contenedor").className = "modalActivado";
    //     $("#ventanaModal").show();
    // });

    // $("#salir").click(function(){
    //     document.getElementById("contenedor").className = "modalDesactivado";
    //     $("#ventanaModal").hide();
    // });



</script>